<?xml version="1.0"?>

<project name="Zekr source build file" default="dist" basedir=".">

	<!-- Component parameters -->
	<property name="component" value="Zekr" />
	<property name="package" value="net.sf.zekr" />
	<property name="packagedir" value="net/sf/zekr" />
	<property name="distfilename" value="zekr" />
	<property name="component_version" value="0.6.0beta1" />

	<property name="main_class" value="${package}.ZekrMain" />

	<!-- Directory setup -->
	<property name="srcdir" value="src" />
	<property name="libdir" value="lib" />
	<property name="docsdir" value="docs" />
	<property name="javadocsdir" value="${docsdir}/javadocs" />

	<property name="builddir" value="build" />
	<property name="build_classdir" value="${builddir}/classes" />

	<property name="distdir" value="dist/${distfilename}.jar" />

	<property name="src_dist.jar" value="dist/zekr-src.jar" />
	<property name="src_dir" value="${builddir}/src" />

	<!-- Excevution tags -->
	<property name="debug" value="off" />
	<property name="verbose" value="no" />

	<!-- Distribution structure -->
	<property name="dist_javadocs" value="${builddir}/${javadocsdir}" />

	<!-- JAR file dependencies -->
	<condition property="swt.jar" value="${libdir}/swt-win32.jar">
		<and>
			<os family="windows" />
		</and>
	</condition>
	<condition property="swt.jar" value="${libdir}/swt-linux.jar">
		<and>
			<os family="unix" arch="" />
		</and>
	</condition>
	<condition property="swt.jar" value="${libdir}/swt-mac.jar">
		<and>
			<os family="mac" />
		</and>
	</condition>
	<property name="velocity.jar" value="${libdir}/velocity-1.4.jar" />
	<property name="log4j.jar" value="${libdir}/log4j-1.2.8.jar" />
	<property name="lucene-core.jar" value="${libdir}/lucene-core-2.2.0.jar" />
	<property name="lucene-highlighter.jar" value="${libdir}/lucene-highlighter-2.2.0.jar" />
	<property name="apache-commons.jar" value="${libdir}/apache-commons.jar" />

	<path id="buildlibs">
		<pathelement location="${log4j.jar}" />
		<pathelement location="${swt.jar}" />
		<pathelement location="${lucene-core.jar}" />
		<pathelement location="${lucene-highlighter.jar}" />
		<pathelement location="${velocity.jar}" />
		<pathelement location="${apache-commons.jar}" />
	</path>

	<target name="compile">
		<mkdir dir="${build_classdir}" />
		<unjar src="${src_dist.jar}" dest="${src_dir}">
		</unjar>
		<javac srcdir="${src_dir}" source="1.4" target="1.4" destdir="${build_classdir}" includes="${packagedir}/**" debug="true" verbose="${verbose}">
			<classpath refid="buildlibs" />
		</javac>
	</target>

	<target name="dist" depends="compile">
		<jar jarfile="${distdir}" basedir="${build_classdir}" />
	</target>

	<target name="javadoc" depends="compile">
		<mkdir dir="${dist_javadocs}" />
		<javadoc packagenames="${package}.*" sourcepath="${src_dir}" classpath="${build_classdir}" classpathref="buildlibs" destdir="${dist_javadocs}" windowtitle="Zekr - Open Quranic Platform" verbose="${verbose}">
			<tag name="copyright" description="Copyright: http://siahe.com" scope="types" />
		</javadoc>
	</target>

	<target name="run" depends="dist">
		<java classname="${main_class}" fork="true">
			<jvmarg value="-Djava.library.path=${libdir}" />
			<env key="MOZILLA_FIVE_HOME" value="/usr/lib/firefox" />
			<classpath location="${distdir}" />
			<classpath refid="buildlibs" />
		</java>
	</target>

	<target name="clean">
		<delete dir="${builddir}" />
		<delete file="${distdir}" />
	</target>

</project>
